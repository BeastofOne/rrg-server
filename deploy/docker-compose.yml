services:
  rrg-router:
    image: rrg-router:latest
    container_name: rrg-router
    restart: unless-stopped
    ports:
      - "8501:8501"
    environment:
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - CLAUDE_MODEL=${CLAUDE_MODEL:-haiku}
      - WORKER_PNL_URL=http://rrg-pnl:8100
      - WORKER_BROCHURE_URL=http://rrg-brochure:8101
      - USE_WINDMILL=${USE_WINDMILL:-true}
      - WINDMILL_BASE_URL=${WINDMILL_BASE_URL:-http://windmill-windmill_server-1:8000}
      - WINDMILL_TOKEN=${WINDMILL_TOKEN}
      - WINDMILL_WORKSPACE=${WINDMILL_WORKSPACE:-rrg}
    tmpfs:
      - /root/.claude:rw,size=50m
      - /tmp:rw
    networks:
      - windmill_default

  rrg-pnl:
    image: rrg-pnl:latest
    container_name: rrg-pnl
    restart: unless-stopped
    expose:
      - "8100"
    environment:
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - CLAUDE_MODEL=${CLAUDE_MODEL:-haiku}
    tmpfs:
      - /root/.claude:rw,size=50m
      - /tmp:rw
    networks:
      - windmill_default

  rrg-brochure:
    image: rrg-brochure:latest
    container_name: rrg-brochure
    restart: unless-stopped
    expose:
      - "8101"
    environment:
      - CLAUDE_CODE_OAUTH_TOKEN=${CLAUDE_CODE_OAUTH_TOKEN}
      - CLAUDE_MODEL=${CLAUDE_MODEL:-haiku}
    tmpfs:
      - /root/.claude:rw,size=50m
      - /tmp:rw
    networks:
      - windmill_default

networks:
  windmill_default:
    external: true
